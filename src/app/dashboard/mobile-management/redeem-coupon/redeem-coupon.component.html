<div id="scanner-container" class="bg-white">
  <zxing-scanner
    #scanner
    [(device)]="currentDevice"
    [tryHarder]="tryHarder"
    (scanSuccess)="onScanSuccess($event)"
    (permissionResponse)="onHasPermission($event)"
    (camerasFound)="onCamerasFound($event)"
  >
  </zxing-scanner>
</div>

<div id="scanned-qr-info" class="mt-3">
  <div class="card h-100">
    <div class="card-header">
      Info de código QR
    </div>
    <div class="card-body">
      <p *ngIf="!couponStatusRetrieved">
        Proceda a leer el código QR que desea canjear el cliente
      </p>

      <p *ngIf="this.coupon && this.customer">
        El código QR corresponde al cupón {{ this.coupon.title }}, intentando
        ser canjeado para el cliente
        {{ this.customer.firstName + " " + this.customer.lastName }}
      </p>

      <div *ngIf="couponStatusRetrieved">
        <hr *ngIf="this.coupon && this.customer" />
        <div
          class="alert alert-primary"
          role="alert"
          *ngIf="!notValid && !alreadyExpired && !alreadyRedeemed"
        >
          <p>El cupón puede ser canjeado</p>
        </div>

        <div
          class="alert alert-danger"
          role="alert"
          *ngIf="notValid || alreadyExpired || alreadyRedeemed"
        >
          <p *ngIf="notValid">
            Código QR no válido para esta operación. Valor del código:
            {{ this.scannedCode }}
          </p>

          <p *ngIf="alreadyRedeemed">
            Este cupón ya fue canjeado por el cliente el día {{ "" }} a las
            {{ "" }}.
          </p>

          <p *ngIf="alreadyExpired">
            Este cupón expiró. Fue válido hasta el día {{ "" }} a las {{ "" }}.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="card mt-3">
  <div class="card-body">
    <div class="d-flex justify-content-between bg-white">
      <button
        class="btn btn-outline-black"
        [disabled]="notValid || alreadyExpired || alreadyExpired"
      >
        Redimir cupón
      </button>
      <button class="btn btn-outline-danger" (click)="cleanScannedCode()">
        Limpiar código
      </button>
    </div>
  </div>
</div>
